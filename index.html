<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="theme.css">
    <title>micro:bit Hide N Seek Setup</title>
    <style>
        .form-group {
            margin-bottom: 10px;
        }

        #questionsContainer {
            display: none;
        }
    </style>
</head>
<body>
    <form id="microbitForm">

        <div id="microbitSetup">
            <div class="form-group">
                <label for="num_seekers">Number of Seeking micro:bits:</label>
                <input type="number" id="num_seekers" name="num_seekers" required>
            </div>

            <div class="form-group">
                <label for="num_beacons">Number of Hidden micro:bits:</label>
                <input type="number" id="num_beacons" name="num_beacons" required>
            </div>
            <button id="continueButton" type="button" onclick="showQuestionsForm()">Continue</button>
        </div>

        <div id="questionsContainer">
        </div>

    </form>

<script>
    function showQuestionsForm() {
    const numBeacons = document.getElementById('num_beacons').value;
    if (numBeacons && !isNaN(numBeacons) && numBeacons > 0) {
        createQuestionInputs();
        
        // Hide setup container and show questions container
        document.getElementById('microbitSetup').style.display = 'none';
        document.getElementById('questionsContainer').style.display = 'block';
    } else {
        alert('Please enter the number of Hidden micro:bits.');
    }
}
     function createAnswerInputs(parentElement, questionType, questionIndex) {
        // Check if there's an existing answersContainer and remove it
        const existingAnswersContainer = parentElement.querySelector('.answersContainer');
        if (existingAnswersContainer) {
            parentElement.removeChild(existingAnswersContainer);
        }

        const answersContainer = document.createElement('div');
        answersContainer.className = 'answersContainer';

        if (questionType === "true_false") {
            // Create true and false radio buttons
            ['True', 'False'].forEach(value => {
                const div = document.createElement('div');

                const radio = document.createElement('input');
                radio.type = 'radio';
                radio.name = `answer_${questionIndex}`;
                radio.value = value.toLowerCase();

                const label = document.createElement('label');
                label.textContent = value;

                div.appendChild(radio);
                div.appendChild(label);
                answersContainer.appendChild(div);
            });
        } else if (questionType === "multiple_choice") {
            // Create 4 multiple choice options
            for (let i = 1; i <= 4; i++) {
                const div = document.createElement('div');

                const correct = document.createElement('input');
                correct.type = 'checkbox';
                correct.name = `mc_correct_${questionIndex}_${i}`;
                const correctLabel = document.createElement('label');
                correctLabel.textContent = 'Correct';
                
                const input = document.createElement('input');
                input.type = 'text';
                input.name = `mc_option_${questionIndex}_${i}`;
                input.placeholder = `Option ${i}`;

                div.appendChild(correct);
                div.appendChild(correctLabel);
                div.appendChild(input);
                answersContainer.appendChild(div);
            }
        }

        parentElement.appendChild(answersContainer);
    }

    function createQuestionInputs() {
        const questionsContainer = document.getElementById('questionsContainer');
        const numQuestions = parseInt(document.getElementById('num_beacons').value, 10);

        // Clear previous inputs
        questionsContainer.innerHTML = '';

        for (let i = 0; i < numQuestions; i++) {
            const div = document.createElement('div');
            div.className = 'form-group';

            const questionLabel = document.createElement('label');
            questionLabel.htmlFor = `question_${i + 1}`;
            questionLabel.textContent = `Question ${i + 1}:`;
            
            const questionInput = document.createElement('input');
            questionInput.type = 'text';
            questionInput.id = `question_${i + 1}`;
            questionInput.name = `question_${i + 1}`;
            
            const typeLabel = document.createElement('label');
            typeLabel.htmlFor = `type_${i + 1}`;
            typeLabel.textContent = `Type for Question ${i + 1}:`;

            const typeSelect = document.createElement('select');
            typeSelect.id = `type_${i + 1}`;
            typeSelect.name = `type_${i + 1}`;
            typeSelect.onchange = () => createAnswerInputs(div, typeSelect.value, i + 1);

            const trueFalseOption = document.createElement('option');
            trueFalseOption.value = 'true_false';
            trueFalseOption.textContent = 'True/False';
            
            const multipleChoiceOption = document.createElement('option');
            multipleChoiceOption.value = 'multiple_choice';
            multipleChoiceOption.textContent = 'Multiple Choice';

            typeSelect.appendChild(trueFalseOption);
            typeSelect.appendChild(multipleChoiceOption);

            div.appendChild(questionLabel);
            div.appendChild(questionInput);
            div.appendChild(typeLabel);
            div.appendChild(typeSelect);

            createAnswerInputs(div, 'true_false', i + 1);

            questionsContainer.appendChild(div);
        }
        const submitButton = document.createElement('button');
            submitButton.id = 'submitQuestionsButton';
            submitButton.type = 'submit';
            submitButton.textContent = 'Submit';
            questionsContainer.appendChild(submitButton);
    }

    // This function will be triggered when the form is submitted.
    document.getElementById('microbitForm').addEventListener('submit', function(event) {
    event.preventDefault();

    // Extract details from the form
    const beacons = document.getElementById('num_beacons').value;
    const seekers = document.getElementById('num_seekers').value;

    const questionElements = Array.from(document.querySelectorAll('#questionsContainer input[type=text]'));
    const questionTypes = Array.from(document.querySelectorAll('#questionsContainer select'));

    const questionsData = questionElements.map((question, index) => {
        const type = questionTypes[index].value;
        const answers = [];

        if (type === 'true_false') {
            const selectedAnswer = document.querySelector(`#questionsContainer input[name=answer_${index + 1}]:checked`);
            answers.push(selectedAnswer ? selectedAnswer.value : 'None selected');
        } else if (type === 'multiple_choice') {
            for (let i = 1; i <= 4; i++) {
                answers.push(document.querySelector(`#questionsContainer input[name=mc_option_${index + 1}_${i}]`).value);
            }
        }

        return {
            question: question.value,
            type,
            answers
        };
    });

    // Displaying the extracted values
    const questionsDisplay = questionsData.map(q => `Question: ${q.question}, Type: ${q.type}, Answers: ${q.answers.join(', ')}`).join('\n');
    alert(`Beacons: ${beacons}\nSeekers: ${seekers}\n${questionsDisplay}`);
});

</script>

</body>
</html>